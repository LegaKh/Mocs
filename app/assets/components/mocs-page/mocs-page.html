<dom-module id="mocs-page">
  <link rel="stylesheet" href="mocs-page.css" />
  <template>

    <paper-tabs selected="{{selectedTab}}">
      <paper-tab>Items</paper-tab>
      <paper-tab>Orders</paper-tab>
    </paper-tabs>

    <iron-ajax
      auto
      url="/items"
      last-response="{{items}}"></iron-ajax>
    <iron-ajax
      auto
      url="/orders"
      last-response="{{orders}}"
      on-response="setCurrentOrder"></iron-ajax>
    <iron-ajax
      id='saveOrder'
      content-type='application/json'
      on-response="handleOrder"></iron-ajax>

    <iron-pages selected="{{selectedTab}}">
      <div>
        <section class="flex layout horizontal wrap" on-add-to-order="addToOrder">
          <template is="dom-repeat" items="{{items}}">
            <mocs-item _id="{{item.id}}" _name="{{item.name}}" _price="{{item.price}}"></mocs-item>
          </template>
        </section>

        <section class="flex layout horizontal wrap" on-add-to-order="addToOrder">
          <span>Order</span>
          <mocs-order _id="{{currentOrder.id}}" _items="{{currentOrder.items}}" _aasm_state="{{currentOrder.aasm_state}}">
          </mocs-order>
        </section>

      </div>

      <div>
        <section class="flex layout horizontal wrap">
          <template id="ordersList" is="dom-repeat" items="{{orders}}" as="order">

            <mocs-order _id="{{order.id}}" _items="{{order.items}}" _aasm_state="{{order.aasm_state}}"></mocs-item>

          </template>
        </section>
      </div>

    </iron-pages>

  </template>

  <script src="mocs-page.js"></script>
</dom-module>
